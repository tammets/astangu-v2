<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teemakavade Haldus</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://unpkg.com/@tailwindcss/browser@4.0.0"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.462.0/lucide.min.css" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="js/main.js"></script>
    
    
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <div id="toast-container"></div>

  <!-- Header -->
  <header class="relative inset-x-0 top-0 z-50 py-6 site-header">
    <div class="mx-auto max-w-7xl">
      <div class="px-6 max-w-7xl mx-auto">
        <nav class="main-nav flex items-center justify-between lg:justify-start" aria-label="Global">
          <a href="index.html" class="-m-1.5 p-1.5 flex items-center gap-2">
            <img alt="Astangu logo" class="h-10 w-auto lg:h-12" src="assets/astangu-logo.svg" />
            <span class="sr-only">Astangu</span>
          </a>
          <button type="button" data-menu-open class="-m-2.5 rounded-md p-2.5 lg:hidden">
            <span class="sr-only">Open main menu</span>
            <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
              aria-hidden="true" data-slot="icon">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
          </button>
          <div class="hidden lg:ml-12 lg:flex lg:gap-x-10 lg:items-center lg:justify-between lg:w-full">
            <div class="flex lg:gap-x-10 items-center">
              <a href="index.html" class="text-base font-semibold lg:text-lg">Avaleht</a>
              <div class="relative group">
                <a href="lak-ope-astangul.html"
                  class="text-base font-semibold lg:text-lg inline-flex items-center gap-1">
                  LAK-õpe Astangul
                  <svg class="size-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor"
                    aria-hidden="true">
                    <path fill-rule="evenodd"
                      d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 1 1 1.06 1.06l-4.24 4.24a.75.75 0 0 1-1.06 0L5.21 8.29a.75.75 0 0 1 .02-1.08Z"
                      clip-rule="evenodd" />
                  </svg>
                </a>
                <div
                  class="absolute left-0 top-full hidden min-w-48 pt-2 group-hover:block group-focus-within:block">
                  <div class="rounded-lg bg-white shadow-lg ring-1 ring-gray-900/10 flex flex-col p-2">
                    <a href="lak-ope-astangul-ajalugu.html"
                      class="rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:bg-gray-50">Ajalugu</a>
                    <a href="lak-ope-astangul-projekti-kirjeldus.html"
                      class="rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:bg-gray-50">Projekti
                      kirjeldus</a>
                    <a href="lak-ope-astangul-edulood.html"
                      class="rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:bg-gray-50">Edulood</a>
                  </div>
                </div>
              </div>
              <div class="relative group">
                <a href="tooriistakast.html"
                  class="text-base font-semibold lg:text-lg inline-flex items-center gap-1">
                  Tööriistakast
                  <svg class="size-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor"
                    aria-hidden="true">
                    <path fill-rule="evenodd"
                      d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 1 1 1.06 1.06l-4.24 4.24a.75.75 0 0 1-1.06 0L5.21 8.29a.75.75 0 0 1 .02-1.08Z"
                      clip-rule="evenodd" />
                  </svg>
                </a>
                <div
                  class="absolute left-0 top-full hidden min-w-48 pt-2 group-hover:block group-focus-within:block">
                  <div class="rounded-lg bg-white shadow-lg ring-1 ring-gray-900/10 flex flex-col p-2">
                    <a href="teemakavad.html"
                      class="rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:bg-gray-50">Teemakavad</a>
                  </div>
                </div>
              </div>
              <a href="https://edgar.smartzoos.eu/lak/" target="_blank" rel="noopener noreferrer"
                class="text-base font-semibold lg:text-lg">Käsiraamat</a>
              <a href="kontakt.html" class="text-base font-semibold lg:text-lg">Kontakt</a>
            </div>
            <a href="login.html" class="px-4 py-2 rounded-md transition-colors login-button">Logi sisse</a>
          </div>
        </nav>
      </div>
    </div>
    <!-- Mobile menu, show/hide based on menu open state. -->
    <div id="mobile-menu-backdrop" class="lg:hidden fixed inset-0 z-50 hidden bg-black/20"></div>
    <div id="mobile-menu"
      class="mobile-menu lg:hidden fixed inset-y-0 right-0 z-50 w-full overflow-y-auto p-6 sm:max-w-sm sm:ring-1 sm:ring-gray-900/10 hidden">
      <div class="flex items-center justify-between">
        <a href="index.html" class="-m-1.5 p-1.5">
          <span class="sr-only">Astangu</span>
          <img class="h-10 w-auto" src="assets/astangu-logo.svg" alt="" />
        </a>
        <button type="button" data-menu-close class="-m-2.5 rounded-md p-2.5">
          <span class="sr-only">Close menu</span>
          <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
            aria-hidden="true" data-slot="icon">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div class="mt-6 flow-root">
        <div class="-my-6 divide-y divide-gray-500/10">
          <div class="space-y-2 py-6">
            <a href="index.html"
              class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold hover:bg-gray-50">Avaleht</a>
            <div class="space-y-2">
              <a href="lak-ope-astangul.html"
                class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold hover:bg-gray-50">LAK-õpe
                Astangul</a>
              <div class="ml-4 space-y-1">
                <a href="lak-ope-astangul-ajalugu.html"
                  class="-mx-3 block rounded-lg px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Ajalugu</a>
                <a href="lak-ope-astangul-projekti-kirjeldus.html"
                  class="-mx-3 block rounded-lg px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Projekti
                  kirjeldus</a>
                <a href="lak-ope-astangul-edulood.html"
                  class="-mx-3 block rounded-lg px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Edulood</a>
              </div>
            </div>
            <div class="space-y-2">
              <a href="tooriistakast.html"
                class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold hover:bg-gray-50">Tööriistakast</a>
              <div class="ml-4 space-y-1">
                <a href="teemakavad.html"
                  class="-mx-3 block rounded-lg px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Teemakavad</a>
              </div>
            </div>
            <a href="https://edgar.smartzoos.eu/lak/" target="_blank" rel="noopener noreferrer"
              class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold hover:bg-gray-50">Käsiraamat</a>
            <a href="kontakt.html"
              class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold hover:bg-gray-50">Kontakt</a>
            <a href="login.html"
              class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold login-button">Logi sisse</a>
          </div>
        </div>
      </div>
    </div>
  </header>

    <main class="flex-1 bg-white">
        <section class="py-12 sm:py-16">
            <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                <div class="mb-8">
                    <div class="flex items-center gap-4 mb-4">
                        <a href="teemakavad.html" class="flex items-center gap-2 text-sm font-medium text-[#5d0f57]" style="text-decoration: underline;">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                            Tagasi teemakavade juurde
                        </a>
                    </div>
                    <h1 class="heading-cond-bold mt-12 text-4xl tracking-tight sm:text-5xl" style="color: #5d0f57;">Uue teemakava loomine</h1>
                    <p class="mt-2 text-lg text-gray-600">Täida allolev vorm teemakava koostamiseks.</p>
                </div>
                <div class="mx-auto">
                    <form id="curriculum-form" class="space-y-10 bg-white">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="title" class="form-label block text-m/6 text-gray-900 mb-2">Pealkiri *</label>
                                    <div class="mt-2">
                                        <input type="text" id="title" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-[#611e59] sm:text-sm/6" placeholder="Näiteks: Emotsioonid" required>
                                    </div>
                                </div>
                                <div>
                                    <label for="subject" class="form-label block text-m/6 text-gray-900 mb-2">Õppeaine *</label>
                                    <div class="mt-2 grid grid-cols-1">
                                        <select id="subject" class="col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pr-8 pl-3 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-[#611e59] sm:text-sm/6" required>
                                            <option value="">Vali õppeaine</option>
                                            <option value="Eesti keel">Eesti keel</option>
                                            <option value="Matemaatika">Matemaatika</option>
                                            <option value="Loodusõpetus">Loodusõpetus</option>
                                            <option value="Ajalugu">Ajalugu</option>
                                            <option value="Geograafia">Geograafia</option>
                                            <option value="Füüsika">Füüsika</option>
                                            <option value="Keemia">Keemia</option>
                                            <option value="Bioloogia">Bioloogia</option>
                                        </select>
                                        <svg viewBox="0 0 16 16" fill="currentColor" data-slot="icon" aria-hidden="true" class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4">
                                            <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" fill-rule="evenodd" />
                                        </svg>
                                    </div>
                                </div>
                                <div>
                                    <label for="field" class="form-label block text-m/6 text-gray-900 mb-2">Valdkond *</label>
                                    <div class="mt-2 grid grid-cols-1">
                                        <select id="field" class="col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pr-8 pl-3 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-[#611e59] sm:text-sm/6" required>
                                            <option value="">Vali valdkond</option>
                                            <option value="Sotsiaalsed oskused">Sotsiaalsed oskused</option>
                                            <option value="Kognitiivsed oskused">Kognitiivsed oskused</option>
                                            <option value="Emotsionaalsed oskused">Emotsionaalsed oskused</option>
                                            <option value="Kommunikatiivsed oskused">Kommunikatiivsed oskused</option>
                                            <option value="Praktiline tegevus">Praktiline tegevus</option>
                                            <option value="Loovus ja kunstiline väljendus">Loovus ja kunstiline väljendus</option>
                                        </select>
                                        <svg viewBox="0 0 16 16" fill="currentColor" data-slot="icon" aria-hidden="true" class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4">
                                            <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" fill-rule="evenodd" />
                                        </svg>
                                    </div>
                                </div>
                                <div>
                                    <label for="plannedHours" class="form-label block text-m/6 text-gray-900 mb-2">Kavandatud tundide arv</label>
                                    <div class="mt-2 grid grid-cols-1">
                                        <select id="plannedHours" class="col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pr-8 pl-3 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-[#611e59] sm:text-sm/6">
                                            <option value="">Vali tundide arv</option>
                                            <option value="1 x 45 minutit">1 x 45 minutit</option>
                                            <option value="2 x 45 minutit">2 x 45 minutit</option>
                                            <option value="3 x 45 minutit">3 x 45 minutit</option>
                                            <option value="4 x 45 minutit">4 x 45 minutit</option>
                                            <option value="5 x 45 minutit">5 x 45 minutit</option>
                                            <option value="6 x 45 minutit">6 x 45 minutit</option>
                                        </select>
                                        <svg viewBox="0 0 16 16" fill="currentColor" data-slot="icon" aria-hidden="true" class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4">
                                            <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" fill-rule="evenodd" />
                                        </svg>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label for="description" class="form-label block text-m/6 text-gray-900 mb-2">Kirjeldus</label>
                                <div class="mt-2">
                                    <textarea id="description" class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-[#611e59] sm:text-sm/6" rows="4" placeholder="Teemakava kirjeldus..."></textarea>
                                </div>
                            </div>

                            <div>
                                <label for="subjectOutcomes" class="form-label block text-m/6 text-gray-900 mb-2">Ainealased õpitulemused</label>
                                <div class="mt-2">
                                    <textarea id="subjectOutcomes" class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-[#611e59] sm:text-sm/6" rows="3" placeholder="Näiteks: õpilane tunneb ära põhiemotsioonid; õpilane seletab, missugustes olukordades tekivad teatud emotsioonid..."></textarea>
                                </div>
                            </div>

                            <div>
                                <label for="languageOutcomes" class="form-label block text-m/6 text-gray-900 mb-2">Keelelised õpitulemused</label>
                                <div class="mt-2">
                                    <textarea id="languageOutcomes" class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-[#611e59] sm:text-sm/6" rows="3" placeholder="Näiteks: õpilane nimetab põhiemotsioone; õpilane tunneb konteksti põhjal ära põhiemotsioonid..."></textarea>
                                </div>
                            </div>

                            <div class="space-y-6">
                                <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                                    <h3 class="text-xl text-gray-900">Tunnid</h3>
                                    <button type="button" id="add-lesson" class="inline-flex items-center gap-2 rounded-md bg-[#611e59] px-3 py-2 text-sm font-normal text-white shadow-sm hover:bg-[#7a2671] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#7a2671] transition-colors">
                                        <i data-lucide="plus" class="w-4 h-4"></i>
                                        Lisa tund
                                    </button>
                                </div>
                                <div id="lessons-container" class="space-y-6"></div>
                            </div>

                            <div class="flex justify-end pt-6">
                                <button type="submit" class="inline-flex items-center justify-center rounded-md bg-[#611e59] px-6 py-2.5 text-base text-white shadow-sm hover:bg-[#7a2671] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#7a2671] transition-colors">
                                    Salvesta teemakava
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="mt-auto">
        <div class="footer-section">
            <div class="footer-title">Astangu Kutserehabilitatsiooni Keskus</div>
            <div class="footer-line">
                <span class="footer-item">Astangu 27, 13519 Tallinn</span>
                <span class="footer-item">tel 659 4152; 659 4327</span>
                <span class="footer-item">faks 659 0520</span>
            </div>
            <div class="footer-line">
                <span class="footer-item">astangu@astangu.ee</span>
                <span class="footer-item">www.astangu.ee</span>
            </div>
        </div>
    </footer>

    <script>
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.getElementById('toast-container').appendChild(toast);

            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function generateId() {
            return Math.random().toString(36).slice(2) + Date.now().toString(36);
        }

        function createLessonForm(lesson, index) {
            const subtopicOptions = ['põhiemotsioonid', 'olukorrad ja emotsioonid', 'emotsioonide väljendamine', 'toimetulekuviisid', 'empaafia', 'suhtlemine'];
            const durations = ['1 x 45 minutit', '2 x 45 minutit', '3 x 45 minutit', '4 x 45 minutit'];
            const inputClasses = 'block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-[#611e59] sm:text-sm/6';
            const textareaClasses = 'block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-[#611e59] sm:text-sm/6';
            const selectClasses = 'col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pr-8 pl-3 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-[#611e59] sm:text-sm/6';
            const primaryButtonClasses = 'inline-flex items-center gap-2 rounded-md bg-[#611e59] px-3 py-2 text-sm font-normal text-white shadow-sm hover:bg-[#7a2671] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#7a2671] transition-colors';
            const removeLinkClasses = 'inline-flex items-center gap-2 text-sm font-medium text-red-600 hover:text-red-500 transition-colors';
            const checkboxClasses = 'lesson-subtopic size-4 rounded border-gray-300 text-[#611e59] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#611e59]';

            return `
                <div class="rounded-xl bg-white shadow-sm" data-lesson-id="${lesson.id}">
                    <div class="flex items-center justify-between gap-4 px-6 py-4 bg-gray-50 rounded-t-xl">
                        <h3 class="text-lg font-semibold text-gray-900">Tund ${index + 1}</h3>
                        <button type="button" class="${removeLinkClasses} remove-lesson" data-lesson-id="${lesson.id}">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                            Eemalda
                        </button>
                    </div>
                    <div class="px-6 py-6 space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block text-m/6 text-gray-900 mb-2">Tunni pealkiri</label>
                                <div class="mt-2">
                                    <input type="text" class="${inputClasses} lesson-title" placeholder="Näiteks: Olukorrad ja emotsioonid" value="${lesson.title}">
                                </div>
                            </div>
                            <div>
                                <label class="form-label block text-m/6 text-gray-900 mb-2">Tunni kestvus</label>
                                <div class="mt-2 grid grid-cols-1">
                                    <select class="${selectClasses} lesson-duration">
                                        <option value="">Vali kestvus</option>
                                        ${durations.map(d => `<option value="${d}" ${lesson.duration === d ? 'selected' : ''}>${d}</option>`).join('')}
                                    </select>
                                    <svg viewBox="0 0 16 16" fill="currentColor" data-slot="icon" aria-hidden="true" class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4">
                                        <path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" fill-rule="evenodd" />
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="form-label block text-m/6 text-gray-900 mb-2">Alamteema (mitmikvalik)</label>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                ${subtopicOptions.map(subtopic => `
                                    <label class="flex items-center gap-2 text-sm text-gray-900 cursor-pointer">
                                        <input type="checkbox" class="${checkboxClasses}" value="${subtopic}" ${lesson.subtopics.includes(subtopic) ? 'checked' : ''}>
                                        <span>${subtopic}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>

                        <div>
                            <label class="form-label block text-m/6 text-gray-900 mb-2">Tunni keeleline eesmärk</label>
                            <div class="mt-2">
                                <input type="text" class="${inputClasses} lesson-language-goal" placeholder="Näiteks: Uue sõnavara tutvustamine ja harjutamine" value="${lesson.languageGoal}">
                            </div>
                        </div>

                        <div>
                            <label class="form-label block text-m/6 text-gray-900 mb-2">Tunni õpiväljundid</label>
                            <div class="mt-2">
                                <textarea class="${textareaClasses} lesson-outcomes" rows="3" placeholder="Näiteks: õpilane tunneb ära põhiemotsioonid; õpilane seletab...">${lesson.outcomes}</textarea>
                            </div>
                        </div>

                        <div>
                            <label class="form-label block text-m/6 text-gray-900 mb-2">Tunnis käsitletavad mõisted</label>
                            <div class="mt-2">
                                <textarea class="${textareaClasses} lesson-concepts" rows="4" placeholder="Näiteks: Põhiemotsioonid: rõõm, viha, üllatus, kurbus...">${lesson.concepts}</textarea>
                            </div>
                        </div>

                        <div class="space-y-4">
                            <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                                <p class="text-base font-semibold text-gray-900">Tunni käik</p>
                                <button type="button" class="${primaryButtonClasses} add-activity" data-lesson-id="${lesson.id}">
                                    <i data-lucide="plus" class="w-4 h-4"></i>
                                    Lisa tegevus
                                </button>
                            </div>
                            <div class="activities-container space-y-3" data-lesson-id="${lesson.id}">
                                ${lesson.activities.length > 0 ? `
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 px-4 py-3 bg-gray-50 rounded-lg text-sm font-medium text-gray-700">
                                        <div>Tunni osad</div>
                                        <div>Arendatavad osaoskused</div>
                                        <div>Plaanitud tegevused</div>
                                        <div>Materjalid ja vahendid</div>
                                    </div>
                                    ${lesson.activities.map(activity => createActivityRow(activity)).join('')}
                                ` : ''}
                            </div>
                        </div>

                        <div>
                            <label class="form-label block text-m/6 text-gray-900 mb-2">Lõimingu võimalused teiste ainetega</label>
                            <div class="mt-2">
                                <textarea class="${textareaClasses} lesson-integration" rows="3" placeholder="Näiteks: Lõiming ainega 'Arvutiõpetus'...">${lesson.integration}</textarea>
                            </div>
                        </div>

                        <div>
                            <label class="form-label block text-m/6 text-gray-900 mb-2">Tegevuste diferentseerimise ja lisaarendamise võimalused</label>
                            <div class="mt-2">
                                <textarea class="${textareaClasses} lesson-differentiation" rows="3" placeholder="Näiteks: 4. ülesannet õpilased saavad teha edasi paaristööna...">${lesson.differentiation}</textarea>
                            </div>
                        </div>

                        <div>
                            <label class="form-label block text-m/6 text-gray-900 mb-2">Enese- ja tunnianalüüs õpetajale</label>
                            <div class="mt-2">
                                <textarea class="${textareaClasses} lesson-self-analysis" rows="3" placeholder="Näiteks: Mis tänases tunnis õnnestus? Mis ei õnnestunud? Miks?">${lesson.selfAnalysis}</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function createActivityRow(activity) {
            const activityTextareaClasses = 'block w-full rounded-md bg-white px-3 py-2 text-sm text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-[#611e59]';

            return `
                <div class="grid grid-cols-1 md:grid-cols-4 gap-3 p-4 bg-white rounded-lg shadow-sm relative activity-row" data-activity-id="${activity.id}">
                    <button type="button" class="absolute -right-3 -top-3 inline-flex items-center justify-center rounded-full bg-red-500 text-white w-7 h-7 hover:bg-red-600 transition-colors remove-activity" data-activity-id="${activity.id}">
                        <i data-lucide="trash-2" class="w-4 h-4"></i>
                    </button>
                    <textarea class="${activityTextareaClasses} activity-part" rows="2" placeholder="1. Emotsioonide laul">${activity.part}</textarea>
                    <textarea class="${activityTextareaClasses} activity-skills" rows="2" placeholder="kuulamine, rääkimine">${activity.skills}</textarea>
                    <textarea class="${activityTextareaClasses} activity-activities" rows="2" placeholder="Õppijad kuulavad emotsioonide laulu...">${activity.activities}</textarea>
                    <textarea class="${activityTextareaClasses} activity-materials" rows="2" placeholder="https://www.youtube.com/...">${activity.materials}</textarea>
                </div>
            `;
        }

        function updateLessonHeadings() {
            document.querySelectorAll('[data-lesson-id]').forEach((lessonEl, index) => {
                const heading = lessonEl.querySelector('h3');
                if (heading) {
                    heading.textContent = `Tund ${index + 1}`;
                }
            });
        }

        function addLesson(prefilledLesson) {
            const lesson = prefilledLesson || {
                id: generateId(),
                title: '',
                subtopics: [],
                languageGoal: '',
                duration: '',
                outcomes: '',
                concepts: '',
                activities: [],
                integration: '',
                differentiation: '',
                selfAnalysis: ''
            };

            const lessonsContainer = document.getElementById('lessons-container');
            const lessonCount = lessonsContainer.querySelectorAll('[data-lesson-id]').length;
            lessonsContainer.insertAdjacentHTML('beforeend', createLessonForm(lesson, lessonCount));
            lucide.createIcons();
            updateLessonHeadings();
        }

        function removeLesson(lessonId) {
            const lesson = document.querySelector(`[data-lesson-id="${lessonId}"]`);
            if (lesson) {
                lesson.remove();
                updateLessonHeadings();
            }
        }

        function addActivity(lessonId) {
            const activity = {
                id: generateId(),
                part: '',
                skills: '',
                activities: '',
                materials: ''
            };

            const container = document.querySelector(`.activities-container[data-lesson-id="${lessonId}"]`);
            if (!container) {
                return;
            }

            if (container.children.length === 0) {
                container.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 px-4 py-3 bg-gray-50 rounded-lg text-sm font-medium text-gray-700">
                        <div>Tunni osad</div>
                        <div>Arendatavad osaoskused</div>
                        <div>Plaanitud tegevused</div>
                        <div>Materjalid ja vahendid</div>
                    </div>
                `;
            }

            container.insertAdjacentHTML('beforeend', createActivityRow(activity));
            lucide.createIcons();
        }

        function removeActivity(activityId) {
            const row = document.querySelector(`[data-activity-id="${activityId}"]`);
            if (row) {
                const container = row.closest('.activities-container');
                row.remove();
                const remainingActivities = container?.querySelectorAll('.activity-row').length || 0;
                if (container && remainingActivities === 0) {
                    container.innerHTML = '';
                }
            }
        }

        function getFormData() {
            const data = {
                title: document.getElementById('title').value.trim(),
                description: document.getElementById('description').value.trim(),
                subject: document.getElementById('subject').value,
                field: document.getElementById('field').value,
                plannedHours: document.getElementById('plannedHours').value,
                subjectOutcomes: document.getElementById('subjectOutcomes').value.trim(),
                languageOutcomes: document.getElementById('languageOutcomes').value.trim(),
                lessons: []
            };

            document.querySelectorAll('[data-lesson-id]').forEach(lessonEl => {
                const lessonId = lessonEl.dataset.lessonId;
                const subtopics = Array.from(lessonEl.querySelectorAll('.lesson-subtopic:checked')).map(cb => cb.value);
                const activities = [];

                lessonEl.querySelectorAll('.activity-row').forEach(activityEl => {
                    activities.push({
                        id: activityEl.dataset.activityId,
                        part: activityEl.querySelector('.activity-part').value.trim(),
                        skills: activityEl.querySelector('.activity-skills').value.trim(),
                        activities: activityEl.querySelector('.activity-activities').value.trim(),
                        materials: activityEl.querySelector('.activity-materials').value.trim()
                    });
                });

                data.lessons.push({
                    id: lessonId,
                    title: lessonEl.querySelector('.lesson-title').value.trim(),
                    subtopics,
                    languageGoal: lessonEl.querySelector('.lesson-language-goal').value.trim(),
                    duration: lessonEl.querySelector('.lesson-duration').value,
                    outcomes: lessonEl.querySelector('.lesson-outcomes').value.trim(),
                    concepts: lessonEl.querySelector('.lesson-concepts').value.trim(),
                    activities,
                    integration: lessonEl.querySelector('.lesson-integration').value.trim(),
                    differentiation: lessonEl.querySelector('.lesson-differentiation').value.trim(),
                    selfAnalysis: lessonEl.querySelector('.lesson-self-analysis').value.trim()
                });
            });

            return data;
        }

        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();

            document.getElementById('add-lesson').addEventListener('click', function() {
                addLesson();
            });

            document.getElementById('curriculum-form').addEventListener('submit', function(event) {
                event.preventDefault();
                const data = getFormData();

                if (!data.title || !data.subject || !data.field) {
                    showToast('Palun täitke kõik kohustuslikud väljad', 'error');
                    return;
                }

                console.log('Teemakava andmed', data);
                showToast('Vorm on edukalt täidetud (andmeid ei salvestata).');
            });

            document.addEventListener('click', function(event) {
                const removeLessonBtn = event.target.closest('.remove-lesson');
                if (removeLessonBtn) {
                    removeLesson(removeLessonBtn.dataset.lessonId);
                    return;
                }

                const addActivityBtn = event.target.closest('.add-activity');
                if (addActivityBtn) {
                    addActivity(addActivityBtn.dataset.lessonId);
                    return;
                }

                const removeActivityBtn = event.target.closest('.remove-activity');
                if (removeActivityBtn) {
                    removeActivity(removeActivityBtn.dataset.activityId);
                }
            });
        });
    </script>
</body>
</html>
